<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Compressor</title>
</head>
<body>
    <h1>Image Compressor</h1>
    <input type="file" id="imageInput" accept="image/*">
    <br>
    <label for="quality">Quality:</label>
    <input type="range" id="quality" min="0" max="100" value="50">
    <br>
    <button id="compressButton">Compress</button>
    <br>
    <!-- Image preview and download link -->
    <a id="downloadLink" download="compressed-image.jpg" style="display:none">Download Compressed Image</a>
    <br>
    <img id="outputImage" alt="Compressed Image" style="display:none; margin-top: 10px;">

    <script>
        document.getElementById('compressButton').addEventListener('click', function(){
            const imageInput = document.getElementById('imageInput').files[0];
            const quality = document.getElementById('quality').value / 100; // convert range between 0 to 1

            if(imageInput){
                const reader = new FileReader();
                reader.onload = function (event) {
                    const img = new Image();
                    img.onload = function () {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        canvas.width = img.width;
                        canvas.height = img.height;
                        ctx.drawImage(img, 0, 0);

                        // Compress and create a Blob
                        canvas.toBlob(function (blob) {
                            const downloadLink = document.getElementById('downloadLink');
                            const outputImage = document.getElementById('outputImage');
                            const url = URL.createObjectURL(blob);

                            downloadLink.href = url;
                            downloadLink.style.display = 'inline';
                            downloadLink.textContent = 'Download Compressed Image';

                            outputImage.src = url;
                            outputImage.style.display = 'inline';
                        }, 'image/jpeg', quality); // Adjust image quality
                    };
                    img.src = event.target.result; // Set image source to result
                };
                reader.readAsDataURL(imageInput); // Start reading the file
            } else {
                alert('Please upload an image.');
            }
        });
    </script>
</body>
</html>
